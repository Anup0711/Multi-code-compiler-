<!DOCTYPE html>
<html lang="en">
<head>
  <!-- SEO Meta Tags -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CodeLab Pro – Beautiful Multi-Language IDE</title>
  <meta name="description" content="Modern online IDE supporting HTML, CSS, JavaScript, Python, Java, C++ and more with live preview.">
  <link rel="canonical" href="https://your-domain.com/codelab-pro">
  <meta name="robots" content="index,follow">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="CodeLab Pro – Multi-Language IDE">
  <meta property="og:description" content="Modern online IDE with live preview for multiple programming languages.">
  <meta property="og:url" content="https://your-domain.com/codelab-pro">
  <meta property="og:image" content="https://your-domain.com/og-image.png">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="CodeLab Pro">
  <meta name="twitter:description" content="Modern online IDE with live preview.">
  <meta name="twitter:image" content="https://your-domain.com/og-image.png">
  
  <!-- JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "CodeLab Pro",
    "operatingSystem": "Web",
    "applicationCategory": "DeveloperApplication",
    "programmingLanguage": ["HTML", "CSS", "JavaScript", "Python", "Java", "C++", "C#", "PHP", "Ruby", "Go"]
  }
  </script>
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
          data-ad-client="ca-pub-YOUR-PUB-ID"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      height: 100vh;
      overflow: hidden;
      color: #333;
    }

    .app {
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Header - Compact */
    .header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      padding: 10px 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 100;
      min-height: 60px;
    }

    .logo {
      font-size: 20px;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-center {
      flex: 1;
      max-width: 300px;
      margin: 0 15px;
    }

    .header-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .btn {
      padding: 8px 16px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 13px;
      white-space: nowrap;
    }

    .run-btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      box-shadow: 0 3px 10px rgba(76, 175, 80, 0.3);
    }

    .run-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
    }

    .save-btn {
      background: linear-gradient(135deg, #2196F3, #1976D2);
      color: white;
    }

    .save-btn:hover {
      transform: translateY(-1px);
    }

    .clear-btn {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
      box-shadow: 0 3px 10px rgba(244, 67, 54, 0.3);
    }

    .clear-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
    }

    /* Main Container - Optimized for screen fit */
    .container {
      flex: 1;
      display: flex;
      gap: 8px;
      padding: 8px;
      height: calc(100vh - 60px);
      min-height: 0;
    }

    /* Left Panel - Compact */
    .language-panel {
      width: 200px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      backdrop-filter: blur(20px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .panel-header {
      background: rgba(255, 255, 255, 0.9);
      padding: 12px;
      font-weight: 600;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      text-align: center;
      font-size: 14px;
    }

    .clear-current-btn {
      background: linear-gradient(135deg, #ff9800, #f57c00);
      color: white;
      padding: 4px 8px;
      font-size: 10px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .clear-current-btn:hover {
      transform: translateY(-1px);
    }

    .language-list {
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    .language-list::-webkit-scrollbar {
      width: 4px;
    }

    .language-list::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.1);
    }

    .language-list::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 2px;
    }

    .lang-item {
      padding: 12px 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      font-size: 14px;
    }

    .lang-item:hover {
      background: rgba(103, 126, 234, 0.1);
    }

    .lang-item.active {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .lang-item.has-code::after {
      content: '●';
      position: absolute;
      right: 12px;
      color: #4CAF50;
      font-size: 10px;
      animation: pulse 2s infinite;
    }

    .lang-item.active.has-code::after {
      color: #fff;
    }

    .lang-icon {
      font-size: 16px;
    }

    .lang-name {
      font-weight: 500;
    }

    /* Editor Panel - Optimized */
    .editor-panel {
      flex: 1;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      backdrop-filter: blur(20px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .editor-header {
      background: rgba(255, 255, 255, 0.9);
      padding: 12px 15px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .current-lang {
      font-weight: 600;
      font-size: 16px;
      color: #667eea;
    }

    .code-stats {
      font-size: 12px;
      color: #666;
    }

    .code-editor {
      flex: 1;
      border: none;
      outline: none;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      padding: 15px;
      background: #1e1e1e;
      color: #e4e6ea;
      resize: none;
    }

    .code-editor::-webkit-scrollbar {
      width: 6px;
    }

    .code-editor::-webkit-scrollbar-track {
      background: #2d3748;
    }

    .code-editor::-webkit-scrollbar-thumb {
      background: #4a5568;
      border-radius: 3px;
    }

    /* Output Panel - Compact */
    .output-panel {
      width: 350px;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 12px;
      backdrop-filter: blur(20px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .output-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.9);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .output-tab {
      flex: 1;
      padding: 10px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: #666;
      transition: all 0.3s ease;
      font-size: 13px;
    }

    .output-tab.active {
      background: rgba(255, 255, 255, 1);
      color: #667eea;
      border-bottom: 2px solid #667eea;
    }

    .output-content {
      flex: 1;
      display: none;
    }

    .output-content.active {
      display: block;
    }

    .console {
      height: 100%;
      background: #1e1e1e;
      color: #e4e6ea;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 12px;
      padding: 10px;
      overflow-y: auto;
      white-space: pre-wrap;
    }

    .preview {
      width: 100%;
      height: 100%;
      border: none;
      background: white;
    }

    /* Status Bar - Compact */
    .status-bar {
      background: rgba(255, 255, 255, 0.9);
      padding: 8px 15px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: #666;
    }

    .status-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #4CAF50;
    }

    .auto-save {
      color: #4CAF50;
      font-weight: 500;
    }

    /* Modal Styles - Improved */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
    }

    .modal-content {
      background: white;
      margin: 10% auto;
      padding: 25px;
      border-radius: 15px;
      width: 380px;
      max-width: 90%;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #333;
    }

    .modal-message {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.4;
      font-size: 14px;
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .modal-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .modal-btn.confirm {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
    }

    .modal-btn.cancel {
      background: #f5f5f5;
      color: #666;
    }

    .modal-btn:hover {
      transform: translateY(-1px);
    }

    /* Ad Container - Compact */
    .ad-container {
      margin: 5px 0;
      text-align: center;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        gap: 5px;
        padding: 5px;
      }

      .language-panel {
        width: 100%;
        height: 100px;
        flex-direction: row;
      }

      .language-list {
        display: flex;
        overflow-x: auto;
        overflow-y: hidden;
        flex-direction: row;
      }

      .lang-item {
        min-width: 80px;
        flex-shrink: 0;
        padding: 8px 10px;
        font-size: 12px;
      }

      .output-panel {
        width: 100%;
        height: 150px;
      }

      .header-actions {
        gap: 5px;
      }

      .btn {
        padding: 6px 12px;
        font-size: 11px;
      }

      .logo {
        font-size: 16px;
      }

      .code-editor {
        font-size: 12px;
      }

      .header-center {
        max-width: 150px;
      }
    }

    @media (max-width: 480px) {
      .header {
        padding: 8px 10px;
        flex-wrap: wrap;
        min-height: 50px;
      }

      .header-center {
        order: 3;
        width: 100%;
        margin: 5px 0 0 0;
        max-width: none;
      }

      .modal-content {
        margin: 20% auto;
        padding: 20px;
        width: 300px;
      }
    }

    .success { color: #4CAF50; }
    .error { color: #f44336; }
    .warning { color: #ff9800; }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Loading animation */
    .loading {
      display: inline-block;
      width: 12px;
      height: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="logo">💻 CodeLab Pro</div>
      
      <div class="header-center">
        <!-- Header Ad Slot -->
        <ins class="adsbygoogle"
             style="display:block;max-height:50px"
             data-ad-client="ca-pub-YOUR-PUB-ID"
             data-ad-slot="YOUR-AD-SLOT"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>

      <div class="header-actions">
        <button class="btn clear-btn" onclick="showClearAllModal()">🗑️ Clear All</button>
        <button class="btn save-btn" onclick="saveProject()">💾 Save</button>
        <button class="btn run-btn" onclick="runCode()">▶ Run</button>
      </div>
    </header>

    <!-- Main Container -->
    <div class="container">
      <!-- Language Panel -->
      <div class="language-panel">
        <div class="panel-header">
          <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
            <span>Languages</span>
            <button class="clear-current-btn" onclick="clearCurrentLanguage()">Clear</button>
          </div>
        </div>
        <div class="language-list">
          <div class="lang-item active" data-lang="html">
            <span class="lang-icon">🌐</span>
            <span class="lang-name">HTML</span>
          </div>
          <div class="lang-item" data-lang="css">
            <span class="lang-icon">🎨</span>
            <span class="lang-name">CSS</span>
          </div>
          <div class="lang-item" data-lang="javascript">
            <span class="lang-icon">⚡</span>
            <span class="lang-name">JavaScript</span>
          </div>
          <div class="lang-item" data-lang="python">
            <span class="lang-icon">🐍</span>
            <span class="lang-name">Python</span>
          </div>
          <div class="lang-item" data-lang="java">
            <span class="lang-icon">☕</span>
            <span class="lang-name">Java</span>
          </div>
          <div class="lang-item" data-lang="cpp">
            <span class="lang-icon">⚙️</span>
            <span class="lang-name">C++</span>
          </div>
          <div class="lang-item" data-lang="csharp">
            <span class="lang-icon">🔷</span>
            <span class="lang-name">C#</span>
          </div>
          <div class="lang-item" data-lang="php">
            <span class="lang-icon">🐘</span>
            <span class="lang-name">PHP</span>
          </div>
          <div class="lang-item" data-lang="ruby">
            <span class="lang-icon">💎</span>
            <span class="lang-name">Ruby</span>
          </div>
          <div class="lang-item" data-lang="go">
            <span class="lang-icon">🚀</span>
            <span class="lang-name">Go</span>
          </div>
        </div>
      </div>

      <!-- Editor Panel -->
      <div class="editor-panel">
        <div class="editor-header">
          <div class="current-lang" id="currentLang">HTML</div>
          <div class="code-stats">
            <span id="lineCount">1 line</span> • 
            <span id="charCount">0 characters</span>
          </div>
        </div>
        
        <textarea class="code-editor" id="codeEditor" placeholder="Start coding here..."></textarea>
        
        <div class="status-bar">
          <div class="status-left">
            <div class="status-dot"></div>
            <span id="statusText">Ready</span>
            <span class="auto-save" id="autoSave">✓ Auto-saved</span>
          </div>
          <span id="lastSaved">Never saved</span>
        </div>
      </div>

      <!-- Output Panel -->
      <div class="output-panel">
        <div class="output-tabs">
          <div class="output-tab active" data-output="preview">🖥️ Preview</div>
          <div class="output-tab" data-output="console">📋 Console</div>
        </div>

        <!-- In-content Ad Slot -->
        <div class="ad-container">
          <ins class="adsbygoogle"
               style="display:block;max-height:60px"
               data-ad-client="ca-pub-YOUR-PUB-ID"
               data-ad-slot="YOUR-AD-SLOT"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
        
        <div class="output-content active" id="preview-content">
          <iframe class="preview" id="preview"></iframe>
        </div>
        
        <div class="output-content" id="console-content">
          <div class="console" id="console">Ready to run code...</div>
        </div>
      </div>
    </div>

    <!-- Clear All Modal -->
    <div id="clearAllModal" class="modal">
      <div class="modal-content">
        <div class="modal-title">⚠️ Clear All Code?</div>
        <div class="modal-message">
          This will permanently delete ALL code from ALL programming languages.
          <br><br>
          <strong>This action cannot be undone!</strong>
        </div>
        <div class="modal-buttons">
          <button class="modal-btn cancel" onclick="closeClearAllModal()">Cancel</button>
          <button class="modal-btn confirm" onclick="confirmClearAll()">🗑️ Clear Everything</button>
        </div>
      </div>
    </div>

    <!-- Clear Current Modal -->
    <div id="clearCurrentModal" class="modal">
      <div class="modal-content">
        <div class="modal-title">⚠️ Clear Current Language?</div>
        <div class="modal-message" id="clearCurrentMessage">
          This will permanently delete all code from the current language.
          <br><br>
          <strong>This action cannot be undone!</strong>
        </div>
        <div class="modal-buttons">
          <button class="modal-btn cancel" onclick="closeClearCurrentModal()">Cancel</button>
          <button class="modal-btn confirm" onclick="confirmClearCurrent()">🗑️ Clear Current</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Default starter code for each language
    const defaultCode = {
      html: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My App</title>
</head>
<body>
    <h1>🚀 Welcome to CodeLab Pro!</h1>
    <p>Start coding here...</p>
    <button onclick="greet()">Click me!</button>
</body>
</html>`,
      css: `body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    margin: 0;
    padding: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: white;
    text-align: center;
}

h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

button {
    padding: 12px 24px;
    background: #4CAF50;
    border: none;
    border-radius: 25px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

button:hover {
    background: #45a049;
    transform: translateY(-2px);
}`,
      javascript: `console.log('🚀 JavaScript loaded!');

function greet() {
    alert('Hello from JavaScript! 🎉');
    console.log('Button clicked successfully!');
}

// Your JavaScript code here
document.addEventListener('DOMContentLoaded', function() {
    console.log('✅ Page loaded and ready!');
});`,
      python: `# Python Code
print("🐍 Hello from Python!")

def main():
    print("Start coding here...")
    
    # Example function
    numbers = [1, 2, 3, 4, 5]
    print("Numbers:", numbers)

if __name__ == "__main__":
    main()`,
      java: `// Java Code
public class Main {
    public static void main(String[] args) {
        System.out.println("☕ Hello from Java!");
        System.out.println("Start coding here...");
        
        // Example code
        int[] numbers = {1, 2, 3, 4, 5};
        System.out.println("Array length: " + numbers.length);
    }
}`,
      cpp: `#include <iostream>
#include <vector>
using namespace std;

// C++ Code
int main() {
    cout << "⚙️ Hello from C++!" << endl;
    cout << "Start coding here..." << endl;
    
    // Example vector
    vector<int> numbers = {1, 2, 3, 4, 5};
    cout << "Vector size: " << numbers.size() << endl;
    
    return 0;
}`,
      csharp: `using System;
using System.Collections.Generic;

// C# Code
namespace MyApp
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("🔷 Hello from C#!");
            Console.WriteLine("Start coding here...");
            
            // Example list
            List<int> numbers = new List<int> {1, 2, 3, 4, 5};
            Console.WriteLine($"List count: {numbers.Count}");
        }
    }
}`,
      php: `<?php
// PHP Code
echo "🐘 Hello from PHP!\\n";
echo "Start coding here...\\n";

// Example array
$numbers = [1, 2, 3, 4, 5];
echo "Array count: " . count($numbers) . "\\n";
?>`,
      ruby: `# Ruby Code
puts "💎 Hello from Ruby!"
puts "Start coding here..."

# Example array
numbers = [1, 2, 3, 4, 5]
puts "Array length: #{numbers.length}"`,
      go: `package main

import "fmt"

// Go Code
func main() {
    fmt.Println("🚀 Hello from Go!")
    fmt.Println("Start coding here...")
    
    // Example slice
    numbers := []int{1, 2, 3, 4, 5}
    fmt.Printf("Slice length: %d\\n", len(numbers))
}`
    };

    // Code storage - starts with default code
    const codeDatabase = { ...defaultCode };
    let currentLanguage = 'html';
    const serverLanguages = ['python', 'java', 'cpp', 'csharp', 'php', 'ruby', 'go'];

    // Load saved code from localStorage
    function loadSavedCode() {
      Object.keys(codeDatabase).forEach(lang => {
        const saved = localStorage.getItem(`codelab_${lang}`);
        if (saved) {
          codeDatabase[lang] = saved;
        }
      });
    }

    // Save code to storage
    function saveCodeToStorage(lang, code) {
      codeDatabase[lang] = code;
      localStorage.setItem(`codelab_${lang}`, code);
      updateHasCodeIndicator(lang);
      showAutoSave();
    }

    // Update "has code" indicator
    function updateHasCodeIndicator(lang) {
      const langItem = document.querySelector(`[data-lang="${lang}"]`);
      if (codeDatabase[lang] && codeDatabase[lang].trim().length > 50) {
        langItem.classList.add('has-code');
      } else {
        langItem.classList.remove('has-code');
      }
    }

    // Show auto-save animation
    function showAutoSave() {
      const autoSave = document.getElementById('autoSave');
      autoSave.style.opacity = '1';
      document.getElementById('lastSaved').textContent = new Date().toLocaleTimeString();
      
      setTimeout(() => {
        autoSave.style.opacity = '0.7';
      }, 2000);
    }

    // Switch language function
    function switchLanguage(newLang) {
      // Save current code before switching
      const currentCode = document.getElementById('codeEditor').value;
      saveCodeToStorage(currentLanguage, currentCode);
      
      // Update UI
      document.querySelectorAll('.lang-item').forEach(item => {
        item.classList.remove('active');
      });
      document.querySelector(`[data-lang="${newLang}"]`).classList.add('active');
      
      // Load new language code
      currentLanguage = newLang;
      document.getElementById('codeEditor').value = codeDatabase[newLang];
      document.getElementById('currentLang').textContent = 
        document.querySelector(`[data-lang="${newLang}"] .lang-name`).textContent;
      
      updateCodeStats();
      updateStatus(`Switched to ${newLang.toUpperCase()}`, 'info');
    }

    // Update code statistics
    function updateCodeStats() {
      const code = document.getElementById('codeEditor').value;
      const lines = code.split('\n').length;
      const chars = code.length;
      
      document.getElementById('lineCount').textContent = `${lines} line${lines !== 1 ? 's' : ''}`;
      document.getElementById('charCount').textContent = `${chars} characters`;
    }

    // Update status
    function updateStatus(message, type = 'info') {
      document.getElementById('statusText').textContent = message;
      document.getElementById('statusText').className = type;
    }

    // Console logging
    function logToConsole(message, type = 'log') {
      const console = document.getElementById('console');
      const timestamp = new Date().toLocaleTimeString();
      console.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
      console.scrollTop = console.scrollHeight;
    }

    // Clear all code functions - FIXED
    function showClearAllModal() {
      document.getElementById('clearAllModal').style.display = 'block';
    }

    function closeClearAllModal() {
      document.getElementById('clearAllModal').style.display = 'none';
    }

    function confirmClearAll() {
      try {
        // Reset all code to empty strings
        Object.keys(codeDatabase).forEach(lang => {
          codeDatabase[lang] = '';
          localStorage.removeItem(`codelab_${lang}`);
          updateHasCodeIndicator(lang);
        });
        
        // Update current editor
        document.getElementById('codeEditor').value = '';
        updateCodeStats();
        
        // Clear console and preview
        document.getElementById('console').innerHTML = 'All code cleared - Ready to start fresh!';
        document.getElementById('preview').src = 'about:blank';
        
        closeClearAllModal();
        updateStatus('All code cleared from all languages!', 'warning');
        logToConsole('🗑️ ALL CODE CLEARED - Fresh start for all languages!', 'warning');
        logToConsole('✨ Ready to start coding from scratch!', 'success');
      } catch (error) {
        console.error('Error clearing all code:', error);
        updateStatus('Error clearing code', 'error');
      }
    }

    // Clear current language function
    function clearCurrentLanguage() {
      const currentLangName = document.querySelector(`[data-lang="${currentLanguage}"] .lang-name`).textContent;
      document.getElementById('clearCurrentMessage').innerHTML = 
        `This will permanently delete all code from <strong>${currentLangName}</strong>.<br><br><strong>This action cannot be undone!</strong>`;
      document.getElementById('clearCurrentModal').style.display = 'block';
    }

    function closeClearCurrentModal() {
      document.getElementById('clearCurrentModal').style.display = 'none';
    }

    function confirmClearCurrent() {
      try {
        const currentLangName = document.querySelector(`[data-lang="${currentLanguage}"] .lang-name`).textContent;
        
        // Reset current language to empty
        codeDatabase[currentLanguage] = '';
        localStorage.removeItem(`codelab_${currentLanguage}`);
        updateHasCodeIndicator(currentLanguage);
        
        // Update editor
        document.getElementById('codeEditor').value = '';
        updateCodeStats();
        
        closeClearCurrentModal();
        updateStatus(`${currentLangName} code cleared!`, 'warning');
        logToConsole(`🗑️ ${currentLangName} code cleared!`, 'warning');
      } catch (error) {
        console.error('Error clearing current code:', error);
        updateStatus('Error clearing code', 'error');
      }
    }

    // Run code function
    function runCode() {
      updateStatus('Running code...', 'info');
      logToConsole('🚀 Executing code...', 'info');
      
      if (['html', 'css', 'javascript'].includes(currentLanguage)) {
        // Web languages - run in preview
        const html = codeDatabase.html;
        const css = codeDatabase.css;
        const js = codeDatabase.javascript;
        
        const fullCode = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${css}</style>
</head>
<body>
  ${html.replace(/<html.*?>|<\/html>|<head.*?>|<\/head>|<body.*?>|<\/body>|<!DOCTYPE.*?>/gi, '')}
  <script>
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;
    
    console.log = function(...args) {
      originalLog.apply(console, args);
      parent.postMessage({type: 'console', level: 'log', message: args.join(' ')}, '*');
    };
    
    console.error = function(...args) {
      originalError.apply(console, args);
      parent.postMessage({type: 'console', level: 'error', message: args.join(' ')}, '*');
    };
    
    console.warn = function(...args) {
      originalWarn.apply(console, args);
      parent.postMessage({type: 'console', level: 'warning', message: args.join(' ')}, '*');
    };
    
    window.addEventListener('error', function(e) {
      parent.postMessage({type: 'console', level: 'error', message: e.message + ' at line ' + e.lineno}, '*');
    });
    
    try {
      ${js}
    } catch (error) {
      parent.postMessage({type: 'console', level: 'error', message: 'JavaScript Error: ' + error.message}, '*');
    }
  <\/script>
</body>
</html>`;
        
        const blob = new Blob([fullCode], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        document.getElementById('preview').src = url;
        
        logToConsole('🌐 Web app loaded successfully!', 'success');
        setTimeout(() => URL.revokeObjectURL(url), 1000);
        
      } else {
        // Server-side languages
        logToConsole(`💻 ${currentLanguage.toUpperCase()} code structure validated`, 'success');
        logToConsole('⚠️ Server-side execution requires backend integration', 'warning');
        logToConsole('💡 Consider using Judge0 API or similar service for execution', 'info');
      }
      
      updateStatus('Code executed successfully!', 'success');
    }

    // Save project function
    function saveProject() {
      try {
        // Save current editor content first
        const currentCode = document.getElementById('codeEditor').value;
        saveCodeToStorage(currentLanguage, currentCode);
        
        const projectData = {
          languages: codeDatabase,
          currentLanguage: currentLanguage,
          timestamp: new Date().toISOString(),
          version: "1.0"
        };
        
        const dataStr = JSON.stringify(projectData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);
        
        const link = document.createElement('a');
        link.href = url;
        link.download = `codelab-project-${Date.now()}.json`;
        link.click();
        
        URL.revokeObjectURL(url);
        updateStatus('Project saved successfully!', 'success');
        logToConsole('💾 Complete project exported!', 'success');
      } catch (error) {
        console.error('Error saving project:', error);
        updateStatus('Error saving project', 'error');
      }
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      try {
        loadSavedCode();
        
        // Language switching
        document.querySelectorAll('.lang-item').forEach(item => {
          item.addEventListener('click', () => {
            switchLanguage(item.dataset.lang);
          });
        });
        
        // Output tab switching
        document.querySelectorAll('.output-tab').forEach(tab => {
          tab.addEventListener('click', () => {
            document.querySelectorAll('.output-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.output-content').forEach(c => c.classList.remove('active'));
            
            tab.classList.add('active');
            document.getElementById(tab.dataset.output + '-content').classList.add('active');
          });
        });
        
        // Code editor input
        const editor = document.getElementById('codeEditor');
        editor.value = codeDatabase[currentLanguage];
        
        editor.addEventListener('input', () => {
          updateCodeStats();
          // Auto-save after 1 second of no typing
          clearTimeout(window.autoSaveTimer);
          window.autoSaveTimer = setTimeout(() => {
            saveCodeToStorage(currentLanguage, editor.value);
          }, 1000);
        });
        
        // Initialize indicators
        Object.keys(codeDatabase).forEach(lang => {
          updateHasCodeIndicator(lang);
        });
        
        updateCodeStats();
        updateStatus('CodeLab Pro ready!', 'success');
        logToConsole('🚀 Welcome to CodeLab Pro!', 'success');
        logToConsole('💡 All functions working properly - Start coding!', 'info');
        
        // Initial run for web languages
        if (['html', 'css', 'javascript'].includes(currentLanguage)) {
          setTimeout(runCode, 1000);
        }
      } catch (error) {
        console.error('Initialization error:', error);
        updateStatus('Initialization error', 'error');
      }
    });

    // Close modals when clicking outside
    window.addEventListener('click', function(event) {
      const clearAllModal = document.getElementById('clearAllModal');
      const clearCurrentModal = document.getElementById('clearCurrentModal');
      
      if (event.target === clearAllModal) {
        closeClearAllModal();
      }
      if (event.target === clearCurrentModal) {
        closeClearCurrentModal();
      }
    });

    // Listen for console messages from iframe
    window.addEventListener('message', function(event) {
      if (event.data.type === 'console') {
        logToConsole(`🖥️ ${event.data.message}`, event.data.level || 'log');
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
          case 'Enter':
            e.preventDefault();
            runCode();
            break;
          case 's':
            e.preventDefault();
            saveProject();
            break;
        }
      }
    });

    // Error handling
    window.addEventListener('error', function(error) {
      console.error('Global error:', error);
      updateStatus('An error occurred', 'error');
    });
  </script>
</body>
</html>
      background: #f8f9fa;
      min-width: 100px;
      max-width: 120px;
      border-right: 1px solid #eee;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    .lang-btn {
      padding: 13px 0;
      background: none;
      border: none;
      font-size: 1.12em;
      color: #444;
      cursor: pointer;
      text-align: center;
      transition: background 0.2s;
    }
    .lang-btn.active, .lang-btn:hover {
      background: #eceffd;
      color: #4b54c1;
      font-weight: bold;
    }
    .editor-panel {
      flex: 3;
      display: flex;
      flex-direction: column;
      min-width: 0;
      background: #fff;
    }
    .editor-header {
      background: #f1f2fa;
      padding: 6px 12px;
      font-size: 1em;
      color: #888;
      border-bottom: 1px solid #ececec;
    }
    textarea {
      flex: 1;
      font-family: 'Fira Mono', monospace;
      font-size: 1em;
      border: none;
      resize: none;
      padding: 18px 12px;
      background: #1e1e1e;
      color: #e4e6ea;
      min-height: 180px;
      min-width: 0;
      outline: none;
      border-radius: 0 0 8px 8px;
    }
    .run-bar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      background: #e8ebfa;
      padding: 6px 12px;
      gap: 10px;
    }
    .run-btn {
      background: #4CAF50;
      border: none;
      color: white;
      border-radius: 20px;
      padding: 8px 20px;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .run-btn:hover { background: #388e3c; }
    .output-panel {
      flex: 2;
      min-width: 0;
      display: flex;
      flex-direction: column;
      background: #eceefd;
      border-left: 1px solid #eee;
    }
    .output-header {
      background: #f1f2fa;
      padding: 6px 12px;
      color: #888;
      border-bottom: 1px solid #ececec;
      font-size: 1em;
    }
    .output-iframe, .output-console {
      flex: 1;
      width: 100%;
      height: 100%;
      border: none;
      background: #fff;
      padding: 0;
      font-size: 0.97em;
    }
    .output-console {
      font-family: "Fira Mono", monospace;
      background: #212121;
      color: #d0f296;
      padding: 14px 10px;
    }
    @media (max-width: 900px) {
      .container { flex-direction: column; }
      .sidebar {
        flex-direction: row;
        max-width: none;
        min-width: 0;
        border-bottom: 1px solid #eee;
        border-right: none;
      }
      .editor-panel, .output-panel { min-height: 175px; }
      .output-panel { border-left: none; border-top: 1px solid #eee; }
    }
    @media (max-width: 520px) {
      .editor-header, .output-header, .run-bar { font-size: 0.98em; }
      textarea { font-size: 0.95em; padding: 12px 6px;}
      .run-btn { font-size: 0.95em; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      CodeStudio Pro
    </header>
    <div class="container">
      <div class="sidebar" id="sidebar">
        <!-- language buttons will go here -->
      </div>
      <div class="editor-panel">
        <div class="editor-header"><span id="langLabel">HTML</span></div>
        <textarea id="codeArea"></textarea>
        <div class="run-bar">
          <button class="run-btn" onclick="runCode()">Run ▶</button>
        </div>
      </div>
      <div class="output-panel">
        <div class="output-header" id="outputHeader">Preview</div>
        <iframe id="iframeOutput" class="output-iframe"></iframe>
        <pre id="consoleOutput" class="output-console" style="display:none;">Ready...</pre>
      </div>
    </div>
  </div>
  <script>
    // Language definitions
    const languages = [
      {id:"html", label:"HTML", icon:"🌐", code:`<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CodeStudio Pro</title>
</head>
<body>
  <h1>Hello from HTML!</h1>
</body>
</html>`},
      {id:"css",label:"CSS",icon:"🎨",code:`body { background: #333; color: white; }`},
      {id:"javascript",label:"JS",icon:"⚡", code:`console.log('Hello from JavaScript!')`},
      {id:"python",label:"Python",icon:"🐍",code:`print("Hello from Python!")`},
      {id:"cpp",label:"C++",icon:"🤖", code:`#include <iostream>
int main() { std::cout << "Hello from C++!\\n"; return 0; }`},
      {id:"csharp",label:"C#",icon:"🔷", code:`using System;\nclass P { static void Main() { Console.WriteLine("Hello from C#!"); } }`},
      {id:"go",label:"Go",icon:"🐹", code:`package main\nimport "fmt"\nfunc main() { fmt.Println("Hello from Go!") }`},
      {id:"ruby",label:"Ruby",icon:"💎", code:`puts "Hello from Ruby!"`}
    ];
    let currLang = languages[0];
    const userCode = {};
    languages.forEach(l => userCode[l.id] = l.code);

    // Sidebar buttons
    const sidebar = document.getElementById('sidebar');
    languages.forEach(lang => {
      const btn = document.createElement('button');
      btn.className = 'lang-btn';
      btn.textContent = lang.icon + " " + lang.label;
      btn.onclick = ()=>{
        switchLang(lang.id);
      };
      btn.id = "btn-"+lang.id;
      sidebar.appendChild(btn);
    });

    // Elements
    const codeArea = document.getElementById('codeArea');
    const langLabel = document.getElementById('langLabel');
    const iframeOutput = document.getElementById('iframeOutput');
    const outputHeader = document.getElementById('outputHeader');
    const consoleOutput = document.getElementById('consoleOutput');

    // Switch language
    function switchLang(id) {
      userCode[currLang.id] = codeArea.value;
      currLang = languages.find(l=>l.id===id);
      codeArea.value = userCode[currLang.id];
      langLabel.textContent = currLang.label;
      document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
      document.getElementById('btn-'+currLang.id).classList.add('active');
      if(['html','css','javascript'].includes(currLang.id)) {
        outputHeader.textContent = 'Preview';
        iframeOutput.style.display = '';
        consoleOutput.style.display = 'none';
      } else {
        outputHeader.textContent = 'Console';
        iframeOutput.style.display = 'none';
        consoleOutput.style.display = '';
        consoleOutput.textContent = "Note: " + currLang.label + " code cannot run in the browser.\nUse Repl.it or an online compiler.";
      }
    }

    // Initial render
    switchLang(currLang.id);

    // Run code
    function runCode() {
      userCode[currLang.id] = codeArea.value;
      if(currLang.id === 'html' || currLang.id === 'css' || currLang.id === 'javascript') {
        // Only for web stack: combine HTML, CSS, JS
        let html = userCode.html || '';
        let css = userCode.css || '';
        let js = userCode.javascript || '';
        const doc = `
        <!DOCTYPE html>
        <html>
        <head>
          <style>${css}</style>
        </head>
        <body>
          ${html}
          <script>
            ${js}
          <\/script>
        </body>
        </html>
        `;
        iframeOutput.srcdoc = doc;
        outputHeader.textContent = 'Preview';
        iframeOutput.style.display = '';
        consoleOutput.style.display = 'none';
      } else {
        outputHeader.textContent = 'Console';
        iframeOutput.style.display = 'none';
        consoleOutput.style.display = '';
        consoleOutput.textContent = "Note: " + currLang.label + " code cannot run in the browser.\nUse Repl.it or an online compiler.";
      }
    }

    // Auto-resize for textarea
    function resizeEditor() {
      codeArea.style.height = "auto";
      codeArea.style.height = Math.max(120, codeArea.scrollHeight) + "px";
    }
    codeArea.addEventListener('input',resizeEditor);
    window.addEventListener('resize',resizeEditor);
    setTimeout(resizeEditor,200);
  </script>
</body>
</html>
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
          data-ad-client="ca-pub-YOUR-PUB-ID"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      height: 100vh;
      overflow: hidden;
      color: #333;
    }

    .app {
      height: 100vh;
      display: flex;
      flex-direction: column;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
    }

    /* Header */
    .header {
      background: rgba(255, 255, 255, 0.98);
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }

    .logo {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .search-container {
      flex: 1;
      max-width: 400px;
      margin: 0 20px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 8px 40px 8px 15px;
      border: 2px solid #e1e5e9;
      border-radius: 25px;
      font-size: 14px;
      outline: none;
      transition: all 0.3s ease;
      background: white;
    }

    .search-input:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .search-icon {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
      font-size: 16px;
    }

    .header-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .btn {
      padding: 8px 18px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      font-size: 13px;
      white-space: nowrap;
    }

    .run-btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      box-shadow: 0 3px 12px rgba(76, 175, 80, 0.3);
    }

    .run-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 5px 18px rgba(76, 175, 80, 0.4);
    }

    .clear-btn {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
      box-shadow: 0 3px 12px rgba(244, 67, 54, 0.3);
    }

    .clear-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 5px 18px rgba(244, 67, 54, 0.4);
    }

    .save-btn {
      background: linear-gradient(135deg, #2196F3, #1976D2);
      color: white;
    }

    .save-btn:hover {
      transform: translateY(-1px);
    }

    /* Main Container */
    .container {
      flex: 1;
      display: flex;
      gap: 8px;
      padding: 8px;
      min-height: 0;
    }

    /* Language Panel */
    .language-panel {
      width: 220px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .panel-header {
      background: #f8f9fa;
      padding: 12px 15px;
      font-weight: 600;
      border-bottom: 1px solid #e9ecef;
      font-size: 14px;
      color: #495057;
    }

    .language-list {
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: rgba(0,0,0,0.2) transparent;
    }

    .language-list::-webkit-scrollbar {
      width: 4px;
    }

    .language-list::-webkit-scrollbar-track {
      background: transparent;
    }

    .language-list::-webkit-scrollbar-thumb {
      background: rgba(0,0,0,0.2);
      border-radius: 2px;
    }

    .lang-item {
      padding: 12px 15px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-bottom: 1px solid #f1f3f4;
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
      font-size: 14px;
    }

    .lang-item:hover {
      background: #f8f9fa;
    }

    .lang-item.active {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .lang-item.has-code::after {
      content: '●';
      position: absolute;
      right: 12px;
      color: #4CAF50;
      font-size: 8px;
      animation: pulse 2s infinite;
    }

    .lang-item.active.has-code::after {
      color: #fff;
    }

    .lang-icon {
      font-size: 16px;
      width: 20px;
      text-align: center;
    }

    .lang-name {
      font-weight: 500;
    }

    .no-results {
      padding: 20px;
      text-align: center;
      color: #6c757d;
      font-size: 14px;
    }

    /* Editor Panel */
    .editor-panel {
      flex: 1;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .editor-header {
      background: #f8f9fa;
      padding: 12px 20px;
      border-bottom: 1px solid #e9ecef;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .current-lang {
      font-weight: 600;
      font-size: 16px;
      color: #667eea;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .code-stats {
      font-size: 12px;
      color: #6c757d;
    }

    .code-editor {
      flex: 1;
      border: none;
      outline: none;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.6;
      padding: 20px;
      background: #1e1e1e;
      color: #e4e6ea;
      resize: none;
    }

    .code-editor::-webkit-scrollbar {
      width: 8px;
    }

    .code-editor::-webkit-scrollbar-track {
      background: #2d3748;
    }

    .code-editor::-webkit-scrollbar-thumb {
      background: #4a5568;
      border-radius: 4px;
    }

    /* Output Panel */
    .output-panel {
      width: 380px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .output-tabs {
      display: flex;
      background: #f8f9fa;
      border-bottom: 1px solid #e9ecef;
    }

    .output-tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: #6c757d;
      transition: all 0.3s ease;
      font-size: 13px;
    }

    .output-tab.active {
      background: white;
      color: #667eea;
      border-bottom: 2px solid #667eea;
    }

    .output-content {
      flex: 1;
      display: none;
    }

    .output-content.active {
      display: block;
    }

    .console {
      height: 100%;
      background: #1e1e1e;
      color: #e4e6ea;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 12px;
      padding: 15px;
      overflow-y: auto;
      white-space: pre-wrap;
    }

    .preview {
      width: 100%;
      height: 100%;
      border: none;
      background: white;
    }

    /* Status Bar */
    .status-bar {
      background: #f8f9fa;
      padding: 8px 20px;
      border-top: 1px solid #e9ecef;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      color: #6c757d;
    }

    .status-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #4CAF50;
    }

    .auto-save {
      color: #4CAF50;
      font-weight: 500;
    }

    /* Ad Container */
    .ad-container {
      margin: 8px 0;
      text-align: center;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
    }

    .modal-content {
      background: white;
      margin: 15% auto;
      padding: 25px;
      border-radius: 15px;
      width: 350px;
      max-width: 90%;
      text-align: center;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #333;
    }

    .modal-message {
      color: #666;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .modal-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .modal-btn.confirm {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
    }

    .modal-btn.cancel {
      background: #f5f5f5;
      color: #666;
    }

    .modal-btn:hover {
      transform: translateY(-1px);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        gap: 5px;
        padding: 5px;
      }

      .language-panel {
        width: 100%;
        height: 120px;
        flex-direction: row;
      }

      .language-list {
        display: flex;
        overflow-x: auto;
        overflow-y: hidden;
        flex-direction: row;
      }

      .lang-item {
        min-width: 100px;
        flex-shrink: 0;
        padding: 10px 12px;
        font-size: 12px;
      }

      .output-panel {
        width: 100%;
        height: 180px;
      }

      .search-container {
        max-width: 250px;
        margin: 0 10px;
      }

      .header-actions {
        gap: 5px;
      }

      .btn {
        padding: 6px 12px;
        font-size: 11px;
      }

      .logo {
        font-size: 18px;
      }
    }

    @media (max-width: 480px) {
      .header {
        padding: 8px 10px;
        flex-wrap: wrap;
        gap: 8px;
      }

      .search-container {
        order: 3;
        width: 100%;
        margin: 5px 0 0 0;
        max-width: none;
      }
    }

    .success { color: #4CAF50; }
    .error { color: #f44336; }
    .warning { color: #ff9800; }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* Loading */
    .loading {
      display: inline-block;
      width: 12px;
      height: 12px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Header -->
    <header class="header">
      <div class="logo">🚀 CodeStudio Pro</div>
      
      <div class="search-container">
        <input type="text" class="search-input" id="searchInput" placeholder="Search languages (e.g., Python, Java, HTML)...">
        <span class="search-icon">🔍</span>
      </div>

      <div class="header-actions">
        <button class="btn clear-btn" onclick="showClearModal()">🗑️ Clear</button>
        <button class="btn save-btn" onclick="saveProject()">💾 Save</button>
        <button class="btn run-btn" onclick="runCode()">▶ Run</button>
      </div>
    </header>

    <!-- Main Container -->
    <div class="container">
      <!-- Language Panel -->
      <div class="language-panel">
        <div class="panel-header">
          Programming Languages
        </div>
        <div class="language-list" id="languageList">
          <!-- Languages will be populated by JavaScript -->
        </div>
      </div>

      <!-- Editor Panel -->
      <div class="editor-panel">
        <div class="editor-header">
          <div class="current-lang" id="currentLang">
            <span class="lang-icon" id="currentIcon">🌐</span>
            <span id="currentName">HTML</span>
          </div>
          <div class="code-stats">
            <span id="lineCount">1 line</span> • 
            <span id="charCount">0 characters</span>
          </div>
        </div>
        
        <textarea class="code-editor" id="codeEditor" placeholder="Start coding here..."></textarea>
        
        <div class="status-bar">
          <div class="status-left">
            <div class="status-dot"></div>
            <span id="statusText">Ready</span>
            <span class="auto-save" id="autoSave">✓ Auto-saved</span>
          </div>
          <span id="lastSaved">Never saved</span>
        </div>
      </div>

      <!-- Output Panel -->
      <div class="output-panel">
        <div class="output-tabs">
          <div class="output-tab active" data-output="preview">🖥️ Preview</div>
          <div class="output-tab" data-output="console">📋 Console</div>
        </div>

        <!-- In-content Ad Slot -->
        <div class="ad-container">
          <ins class="adsbygoogle"
               style="display:block;max-height:60px;"
               data-ad-client="ca-pub-YOUR-PUB-ID"
               data-ad-slot="YOUR-AD-SLOT"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
        
        <div class="output-content active" id="preview-content">
          <iframe class="preview" id="preview"></iframe>
        </div>
        
        <div class="output-content" id="console-content">
          <div class="console" id="console">Ready to run code...</div>
        </div>
      </div>
    </div>

    <!-- Clear Modal -->
    <div id="clearModal" class="modal">
      <div class="modal-content">
        <div class="modal-title">⚠️ Clear All Code?</div>
        <div class="modal-message">
          This will permanently delete all your code from all languages.
          <br><br>
          <strong>This action cannot be undone!</strong>
        </div>
        <div class="modal-buttons">
          <button class="modal-btn cancel" onclick="closeClearModal()">Cancel</button>
          <button class="modal-btn confirm" onclick="confirmClear()">🗑️ Clear All</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Extended language definitions with more languages
    const languages = [
      {
        id: 'html',
        name: 'HTML',
        icon: '🌐',
        code: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeStudio Pro</title>
</head>
<body>
    <div class="container">
        <h1>🚀 Welcome to CodeStudio Pro!</h1>
        <p>Start building amazing web applications!</p>
        <button onclick="showAlert()">Click me!</button>
    </div>
</body>
</html>`
      },
      {
        id: 'css',
        name: 'CSS',
        icon: '🎨',
        code: `body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    margin: 0;
    padding: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    color: white;
}

.container {
    max-width: 600px;
    margin: 0 auto;
    text-align: center;
    padding: 40px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 20px;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

h1 {
    font-size: 2.5em;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    animation: fadeIn 1s ease-in;
}

button {
    padding: 12px 24px;
    background: #4CAF50;
    border: none;
    border-radius: 25px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

button:hover {
    background: #45a049;
    transform: translateY(-2px);
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
}`
      },
      {
        id: 'javascript',
        name: 'JavaScript',
        icon: '⚡',
        code: `console.log('🚀 Welcome to CodeStudio Pro!');

function showAlert() {
    alert('Hello from JavaScript! 🎉');
    console.log('Button clicked successfully!');
}

// Your JavaScript code here
document.addEventListener('DOMContentLoaded', function() {
    console.log('✅ Page loaded and ready!');
    
    const title = document.querySelector('h1');
    if (title) {
        title.addEventListener('click', function() {
            this.style.transform = 'scale(1.1)';
            setTimeout(() => this.style.transform = 'scale(1)', 200);
        });
    }
});`
      },
      {
        id: 'python',
        name: 'Python',
        icon: '🐍',
        code: `# Python Programming
print("🐍 Hello from Python!")
print("Welcome to CodeStudio Pro!")

def main():
    """Main function demonstrating Python features"""
    # List comprehension
    numbers = [x**2 for x in range(10)]
    print("Squares:", numbers)
    
    # Dictionary
    languages = {
        'web': 'JavaScript',
        'data': 'Python',
        'mobile': 'Swift'
    }
    
    for category, lang in languages.items():
        print(f"{category}: {lang}")

if __name__ == "__main__":
    main()`
      },
      {
        id: 'java',
        name: 'Java',
        icon: '☕',
        code: `// Java Programming
import java.util.*;

public class CodeStudioPro {
    public static void main(String[] args) {
        System.out.println("☕ Hello from Java!");
        System.out.println("Welcome to CodeStudio Pro!");
        
        CodeStudioPro app = new CodeStudioPro();
        app.demonstrateFeatures();
    }
    
    public void demonstrateFeatures() {
        // ArrayList example
        List<String> languages = new ArrayList<>();
        languages.add("Java");
        languages.add("Python");
        languages.add("JavaScript");
        
        System.out.println("Supported languages:");
        for (String lang : languages) {
            System.out.println("- " + lang);
        }
        
        // Calculate sum
        int result = calculateSum(10, 20);
        System.out.println("Sum: " + result);
    }
    
    public int calculateSum(int a, int b) {
        return a + b;
    }
}`
      },
      {
        id: 'cpp',
        name: 'C++',
        icon: '⚙️',
        code: `#include <iostream>
#include <vector>
#include <string>

using namespace std;

class CodeStudioPro {
private:
    string appName;
    
public:
    CodeStudioPro(string name) : appName(name) {}
    
    void displayWelcome() {
        cout << "⚙️ Hello from C++!" << endl;
        cout << "App: " << appName << endl;
    }
    
    void demonstrateFeatures() {
        // Vector example
        vector<int> numbers = {1, 2, 3, 4, 5};
        cout << "Vector elements: ";
        for (int num : numbers) {
            cout << num << " ";
        }
        cout << endl;
        
        // Function call
        int result = calculateSum(15, 25);
        cout << "Sum: " << result << endl;
    }
    
    int calculateSum(int a, int b) {
        return a + b;
    }
};

int main() {
    CodeStudioPro app("C++ Code Runner");
    app.displayWelcome();
    app.demonstrateFeatures();
    
    return 0;
}`
      },
      {
        id: 'csharp',
        name: 'C#',
        icon: '🔷',
        code: `using System;
using System.Collections.Generic;
using System.Linq;

namespace CodeStudioPro
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("🔷 Hello from C#!");
            Console.WriteLine("Welcome to CodeStudio Pro!");
            
            var app = new CodeRunner();
            app.DemonstrateFeatures();
        }
    }
    
    public class CodeRunner
    {
        public void DemonstrateFeatures()
        {
            // List example
            List<string> languages = new List<string>
            {
                "C#", "Python", "Java", "JavaScript"
            };
            
            Console.WriteLine("Supported languages:");
            foreach (string lang in languages)
            {
                Console.WriteLine($"- {lang}");
            }
            
            // LINQ example
            var longNames = languages.Where(lang => lang.Length > 4).ToList();
            Console.WriteLine($"Long names: {string.Join(", ", longNames)}");
            
            // Method call
            int result = CalculateSum(30, 40);
            Console.WriteLine($"Sum: {result}");
        }
        
        public int CalculateSum(int a, int b)
        {
            return a + b;
        }
    }
}`
      },
      {
        id: 'php',
        name: 'PHP',
        icon: '🐘',
        code: `<?php
// PHP Programming
echo "🐘 Hello from PHP!\\n";
echo "Welcome to CodeStudio Pro!\\n";

class CodeStudioPro {
    private $appName;
    
    public function __construct($name) {
        $this->appName = $name;
    }
    
    public function displayWelcome() {
        echo "App: " . $this->appName . "\\n";
    }
    
    public function demonstrateFeatures() {
        // Array example
        $numbers = [1, 2, 3, 4, 5];
        echo "Array: " . implode(", ", $numbers) . "\\n";
        
        // Associative array
        $languages = [
            "web" => "JavaScript",
            "server" => "PHP",
            "data" => "Python"
        ];
        
        echo "Language categories:\\n";
        foreach ($languages as $category => $language) {
            echo "- $category: $language\\n";
        }
        
        // Function call
        $result = $this->calculateSum(50, 60);
        echo "Sum: $result\\n";
    }
    
    public function calculateSum($a, $b) {
        return $a + $b;
    }
}

$app = new CodeStudioPro("PHP Code Runner");
$app->displayWelcome();
$app->demonstrateFeatures();
?>`
      },
      {
        id: 'ruby',
        name: 'Ruby',
        icon: '💎',
        code: `# Ruby Programming
puts "💎 Hello from Ruby!"
puts "Welcome to CodeStudio Pro!"

class CodeStudioPro
  def initialize(app_name)
    @app_name = app_name
  end
  
  def display_welcome
    puts "App: #{@app_name}"
  end
  
  def demonstrate_features
    # Array example
    numbers = [1, 2, 3, 4, 5]
    puts "Array: #{numbers.join(', ')}"
    
    # Hash example
    languages = {
      web: "JavaScript",
      mobile: "Swift",
      system: "Rust",
      data: "Python"
    }
    
    puts "Language categories:"
    languages.each do |category, language|
      puts "- #{category}: #{language}"
    end
    
    # Method call
    result = calculate_sum(70, 80)
    puts "Sum: #{result}"
    
    # Block example
    puts "Iterations:"
    (1..5).each { |i| puts "Iteration: #{i}" }
  end
  
  def calculate_sum(a, b)
    a + b
  end
end

app = CodeStudioPro.new("Ruby Code Runner")
app.display_welcome
app.demonstrate_features`
      },
      {
        id: 'go',
        name: 'Go',
        icon: '🚀',
        code: `package main

import (
    "fmt"
    "strings"
)

type CodeStudioPro struct {
    AppName string
}

func (c *CodeStudioPro) DisplayWelcome() {
    fmt.Println("🚀 Hello from Go!")
    fmt.Printf("App: %s\\n", c.AppName)
}

func (c *CodeStudioPro) DemonstrateFeatures() {
    // Slice example
    numbers := []int{1, 2, 3, 4, 5}
    fmt.Printf("Slice: %v\\n", numbers)
    
    // Map example
    languages := map[string]string{
        "web":    "JavaScript",
        "mobile": "Flutter",
        "system": "Go",
        "data":   "Python",
    }
    
    fmt.Println("Language categories:")
    for category, language := range languages {
        fmt.Printf("- %s: %s\\n", category, language)
    }
    
    // Function call
    result := c.CalculateSum(90, 100)
    fmt.Printf("Sum: %d\\n", result)
    
    // String manipulation
    message := "Welcome to Go Programming!"
    fmt.Printf("Message: %s\\n", strings.ToUpper(message))
}

func (c *CodeStudioPro) CalculateSum(a, b int) int {
    return a + b
}

func main() {
    app := &CodeStudioPro{AppName: "Go Code Runner"}
    app.DisplayWelcome()
    app.DemonstrateFeatures()
}`
      },
      {
        id: 'typescript',
        name: 'TypeScript',
        icon: '🔷',
        code: `// TypeScript Programming
console.log('🔷 Hello from TypeScript!');

interface Language {
    name: string;
    year: number;
    paradigm: string[];
}

class CodeStudioPro {
    private appName: string;
    private languages: Language[];

    constructor(appName: string) {
        this.appName = appName;
        this.languages = [
            { name: 'TypeScript', year: 2012, paradigm: ['Object-oriented', 'Functional'] },
            { name: 'JavaScript', year: 1995, paradigm: ['Multi-paradigm'] },
            { name: 'Python', year: 1991, paradigm: ['Multi-paradigm'] }
        ];
    }

    displayWelcome(): void {
        console.log(\`App: \${this.appName}\`);
    }

    demonstrateFeatures(): void {
        // Array methods
        const modernLanguages = this.languages.filter(lang => lang.year > 2000);
        console.log('Modern languages:', modernLanguages.map(lang => lang.name));

        // Generic function
        const result = this.calculateSum<number>(100, 200);
        console.log(\`Sum: \${result}\`);

        // Optional chaining
        const firstLanguage = this.languages[0]?.name ?? 'Unknown';
        console.log(\`First language: \${firstLanguage}\`);
    }

    calculateSum<T extends number>(a: T, b: T): T {
        return (a + b) as T;
    }
}

const app = new CodeStudioPro('TypeScript Code Runner');
app.displayWelcome();
app.demonstrateFeatures();`
      },
      {
        id: 'swift',
        name: 'Swift',
        icon: '🍎',
        code: `// Swift Programming
import Foundation

print("🍎 Hello from Swift!")
print("Welcome to CodeStudio Pro!")

struct Language {
    let name: String
    let year: Int
    let paradigm: [String]
}

class CodeStudioPro {
    private let appName: String
    private let languages: [Language]
    
    init(appName: String) {
        self.appName = appName
        self.languages = [
            Language(name: "Swift", year: 2014, paradigm: ["Multi-paradigm"]),
            Language(name: "Objective-C", year: 1984, paradigm: ["Object-oriented"]),
            Language(name: "JavaScript", year: 1995, paradigm: ["Multi-paradigm"])
        ]
    }
    
    func displayWelcome() {
        print("App: \\(appName)")
    }
    
    func demonstrateFeatures() {
        // Higher-order functions
        let modernLanguages = languages.filter { $0.year > 2000 }
        let languageNames = modernLanguages.map { $0.name }
        print("Modern languages: \\(languageNames)")
        
        // Optionals
        let firstLanguage = languages.first?.name ?? "Unknown"
        print("First language: \\(firstLanguage)")
        
        // Function call
        let result = calculateSum(a: 150, b: 250)
        print("Sum: \\(result)")
    }
    
    func calculateSum(a: Int, b: Int) -> Int {
        return a + b
    }
}

let app = CodeStudioPro(appName: "Swift Code Runner")
app.displayWelcome()
app.demonstrateFeatures()`
      },
      {
        id: 'kotlin',
        name: 'Kotlin',
        icon: '🎯',
        code: `// Kotlin Programming
fun main() {
    println("🎯 Hello from Kotlin!")
    println("Welcome to CodeStudio Pro!")
    
    val app = CodeStudioPro("Kotlin Code Runner")
    app.displayWelcome()
    app.demonstrateFeatures()
}

data class Language(
    val name: String,
    val year: Int,
    val paradigm: List<String>
)

class CodeStudioPro(private val appName: String) {
    private val languages = listOf(
        Language("Kotlin", 2011, listOf("Object-oriented", "Functional")),
        Language("Java", 1995, listOf("Object-oriented")),
        Language("Scala", 2003, listOf("Multi-paradigm"))
    )
    
    fun displayWelcome() {
        println("App: $appName")
    }
    
    fun demonstrateFeatures() {
        // Collection operations
        val modernLanguages = languages.filter { it.year > 2000 }
        val languageNames = modernLanguages.map { it.name }
        println("Modern languages: $languageNames")
        
        // Extension functions
        val message = "kotlin programming".capitalize()
        println("Message: $message")
        
        // Null safety
        val firstLanguage = languages.firstOrNull()?.name ?: "Unknown"
        println("First language: $firstLanguage")
        
        // Function call
        val result = calculateSum(200, 300)
        println("Sum: $result")
        
        // Lambda expressions
        languages.forEach { language ->
            println("${language.name} (${language.year})")
        }
    }
    
    fun calculateSum(a: Int, b: Int): Int = a + b
}

// Extension function
fun String.capitalize(): String =
    this.replaceFirstChar { if (it.isLowerCase()) it.titlecase() else it.toString() }`
      },
      {
        id: 'rust',
        name: 'Rust',
        icon: '🦀',
        code: `// Rust Programming
use std::collections::HashMap;

fn main() {
    println!("🦀 Hello from Rust!");
    println!("Welcome to CodeStudio Pro!");
    
    let app = CodeStudioPro::new("Rust Code Runner".to_string());
    app.display_welcome();
    app.demonstrate_features();
}

struct Language {
    name: String,
    year: u32,
    paradigm: Vec<String>,
}

struct CodeStudioPro {
    app_name: String,
    languages: Vec<Language>,
}

impl CodeStudioPro {
    fn new(app_name: String) -> Self {
        let languages = vec![
            Language {
                name: "Rust".to_string(),
                year: 2010,
                paradigm: vec!["Systems".to_string(), "Functional".to_string()],
            },
            Language {
                name: "C++".to_string(),
                year: 1985,
                paradigm: vec!["Multi-paradigm".to_string()],
            },
        ];
        
        CodeStudioPro { app_name, languages }
    }
    
    fn display_welcome(&self) {
        println!("App: {}", self.app_name);
    }
    
    fn demonstrate_features(&self) {
        // Iterator methods
        let modern_languages: Vec<&String> = self.languages
            .iter()
            .filter(|lang| lang.year > 2000)
            .map(|lang| &lang.name)
            .collect();
        
        println!("Modern languages: {:?}", modern_languages);
        
        // HashMap example
        let mut language_map = HashMap::new();
        language_map.insert("systems", "Rust");
        language_map.insert("web", "JavaScript");
        
        for (category, language) in &language_map {
            println!("{}: {}", category, language);
        }
        
        // Function call
        let result = self.calculate_sum(400, 500);
        println!("Sum: {}", result);
        
        // Pattern matching
        let number = 42;
        match number {
            0 => println!("Zero"),
            1..=50 => println!("Small number"),
            _ => println!("Large number"),
        }
    }
    
    fn calculate_sum(&self, a: i32, b: i32) -> i32 {
        a + b
    }
}`
      },
      {
        id: 'sql',
        name: 'SQL',
        icon: '🗃️',
        code: `-- SQL Database Queries
-- Welcome to CodeStudio Pro SQL Editor!

-- Create a sample database schema
CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(150) UNIQUE NOT NULL,
    age INTEGER,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS posts (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    title VARCHAR(200) NOT NULL,
    content TEXT,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);

-- Insert sample data
INSERT INTO users (name, email, age) VALUES 
    ('Alice Johnson', 'alice@example.com', 28),
    ('Bob Smith', 'bob@example.com', 35),
    ('Carol Davis', 'carol@example.com', 31);

INSERT INTO posts (user_id, title, content) VALUES 
    (1, 'Getting Started with SQL', 'SQL is a powerful language for managing databases...'),
    (2, 'Advanced Joins', 'Understanding different types of joins in SQL...'),
    (1, 'Database Optimization', 'Tips for optimizing database performance...');

-- Query examples
-- 1. Select all users
SELECT * FROM users;

-- 2. Select users with age greater than 30
SELECT name, email 
FROM users 
WHERE age > 30;

-- 3. Join users with their posts
SELECT u.name, u.email, p.title, p.created_at
FROM users u
INNER JOIN posts p ON u.id = p.user_id
ORDER BY p.created_at DESC;

-- 4. Count posts per user
SELECT u.name, COUNT(p.id) as post_count
FROM users u
LEFT JOIN posts p ON u.id = p.user_id
GROUP BY u.id, u.name;

-- 5. Find users who haven't posted
SELECT u.name, u.email
FROM users u
LEFT JOIN posts p ON u.id = p.user_id
WHERE p.id IS NULL;`
      }
    ];

    // Code storage
    const codeStorage = {};
    let currentLanguage = 'html';
    let filteredLanguages = [...languages];

    // Initialize code storage
    languages.forEach(lang => {
      codeStorage[lang.id] = lang.code;
    });

    // DOM elements
    const searchInput = document.getElementById('searchInput');
    const languageList = document.getElementById('languageList');
    const codeEditor = document.getElementById('codeEditor');
    const currentIcon = document.getElementById('currentIcon');
    const currentName = document.getElementById('currentName');
    const statusText = document.getElementById('statusText');
    const autoSave = document.getElementById('autoSave');
    const lastSaved = document.getElementById('lastSaved');
    const lineCount = document.getElementById('lineCount');
    const charCount = document.getElementById('charCount');
    const preview = document.getElementById('preview');
    const console = document.getElementById('console');

    // Load saved code from localStorage
    function loadSavedCode() {
      languages.forEach(lang => {
        const saved = localStorage.getItem(`codestudio_${lang.id}`);
        if (saved) {
          codeStorage[lang.id] = saved;
        }
      });
    }

    // Save code to localStorage
    function saveCodeToStorage(langId, code) {
      codeStorage[langId] = code;
      localStorage.setItem(`codestudio_${langId}`, code);
      showAutoSave();
    }

    // Show auto-save indicator
    function showAutoSave() {
      autoSave.style.opacity = '1';
      lastSaved.textContent = new Date().toLocaleTimeString();
      setTimeout(() => {
        autoSave.style.opacity = '0.7';
      }, 2000);
    }

    // Render language list
    function renderLanguages(searchTerm = '') {
      filteredLanguages = languages.filter(lang => 
        lang.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        lang.id.toLowerCase().includes(searchTerm.toLowerCase())
      );

      languageList.innerHTML = '';

      if (filteredLanguages.length === 0) {
        languageList.innerHTML = '<div class="no-results">No languages found</div>';
        return;
      }

      filteredLanguages.forEach(lang => {
        const item = document.createElement('div');
        item.className = 'lang-item';
        if (lang.id === currentLanguage) {
          item.classList.add('active');
        }
        if (codeStorage[lang.id] && codeStorage[lang.id].trim().length > 100) {
          item.classList.add('has-code');
        }

        item.innerHTML = `
          <span class="lang-icon">${lang.icon}</span>
          <span class="lang-name">${lang.name}</span>
        `;

        item.addEventListener('click', () => switchLanguage(lang.id));
        languageList.appendChild(item);
      });
    }

    // Switch language
    function switchLanguage(langId) {
      // Save current code
      saveCodeToStorage(currentLanguage, codeEditor.value);

      // Find language
      const lang = languages.find(l => l.id === langId);
      if (!lang) return;

      // Update current language
      currentLanguage = langId;
      currentIcon.textContent = lang.icon;
      currentName.textContent = lang.name;

      // Load code
      codeEditor.value = codeStorage[langId];

      // Update UI
      renderLanguages(searchInput.value);
      updateCodeStats();
      updateStatus(`Switched to ${lang.name}`, 'info');
    }

    // Update code statistics
    function updateCodeStats() {
      const code = codeEditor.value;
      const lines = code.split('\n').length;
      const chars = code.length;

      lineCount.textContent = `${lines} line${lines !== 1 ? 's' : ''}`;
      charCount.textContent = `${chars} character${chars !== 1 ? 's' : ''}`;
    }

    // Update status
    function updateStatus(message, type = 'info') {
      statusText.textContent = message;
      statusText.className = type;
    }

    // Console logging
    function logToConsole(message, type = 'log') {
      const timestamp = new Date().toLocaleTimeString();
      console.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
      console.scrollTop = console.scrollHeight;
    }

    // Clear console
    function clearConsole() {
      console.innerHTML = 'Console cleared...';
    }

    // Run code
    function runCode() {
      updateStatus('Running code...', 'info');
      clearConsole();
      logToConsole('🚀 Executing code...', 'info');

      if (['html', 'css', 'javascript'].includes(currentLanguage)) {
        // Web languages
        const html = codeStorage.html || '';
        const css = codeStorage.css || '';
        const js = codeStorage.javascript || '';

        const fullCode = `<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>${css}</style>
</head>
<body>
  ${html.replace(/<html.*?>|<\/html>|<head.*?>|<\/head>|<body.*?>|<\/body>|<!DOCTYPE.*?>/gi, '')}
  <script>
    const originalLog = console.log;
    const originalError = console.error;
    const originalWarn = console.warn;
    
    console.log = function(...args) {
      originalLog.apply(console, args);
      parent.postMessage({type: 'console', level: 'log', message: args.join(' ')}, '*');
    };
    
    console.error = function(...args) {
      originalError.apply(console, args);
      parent.postMessage({type: 'console', level: 'error', message: args.join(' ')}, '*');
    };
    
    console.warn = function(...args) {
      originalWarn.apply(console, args);
      parent.postMessage({type: 'console', level: 'warning', message: args.join(' ')}, '*');
    };
    
    window.addEventListener('error', function(e) {
      parent.postMessage({type: 'console', level: 'error', message: 'Error: ' + e.message + ' at line ' + e.lineno}, '*');
    });
    
    try {
      ${js}
    } catch (error) {
      parent.postMessage({type: 'console', level: 'error', message: 'JavaScript Error: ' + error.message}, '*');
    }
  <\/script>
</body>
</html>`;

        const blob = new Blob([fullCode], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        preview.src = url;

        logToConsole('🌐 Web application loaded successfully!', 'success');
        setTimeout(() => URL.revokeObjectURL(url), 1000);

      } else {
        // Server-side languages
        logToConsole(`💻 ${currentName.textContent} code structure validated`, 'success');
        logToConsole('⚠️ Server-side execution requires backend integration', 'warning');
        logToConsole('💡 Consider using online compilers or local development environment', 'info');
      }

      updateStatus('Code executed successfully!', 'success');
    }

    // Save project
    function saveProject() {
      try {
        // Save current code
        saveCodeToStorage(currentLanguage, codeEditor.value);

        const projectData = {
          languages: codeStorage,
          currentLanguage: currentLanguage,
          timestamp: new Date().toISOString(),
          version: "2.0"
        };

        const dataStr = JSON.stringify(projectData, null, 2);
        const dataBlob = new Blob([dataStr], {type: 'application/json'});
        const url = URL.createObjectURL(dataBlob);

        const link = document.createElement('a');
        link.href = url;
        link.download = `codestudio-project-${Date.now()}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        URL.revokeObjectURL(url);
        updateStatus('Project saved successfully!', 'success');
        logToConsole('💾 Complete project exported!', 'success');
      } catch (error) {
        console.error('Error saving project:', error);
        updateStatus('Error saving project', 'error');
      }
    }

    // Clear modal functions
    function showClearModal() {
      document.getElementById('clearModal').style.display = 'block';
    }

    function closeClearModal() {
      document.getElementById('clearModal').style.display = 'none';
    }

    function confirmClear() {
      try {
        // Clear all code
        languages.forEach(lang => {
          codeStorage[lang.id] = '';
          localStorage.removeItem(`codestudio_${lang.id}`);
        });

        // Update editor
        codeEditor.value = '';
        updateCodeStats();
        renderLanguages(searchInput.value);

        // Clear outputs
        clearConsole();
        preview.src = 'about:blank';

        closeClearModal();
        updateStatus('All code cleared!', 'warning');
        logToConsole('🗑️ All code cleared from all languages!', 'warning');
      } catch (error) {
        console.error('Error clearing code:', error);
        updateStatus('Error clearing code', 'error');
      }
    }

    // Search functionality
    searchInput.addEventListener('input', (e) => {
      renderLanguages(e.target.value);
    });

    // Output tab switching
    document.querySelectorAll('.output-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.output-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.output-content').forEach(c => c.classList.remove('active'));

        tab.classList.add('active');
        document.getElementById(tab.dataset.output + '-content').classList.add('active');
      });
    });

    // Editor input handling
    codeEditor.addEventListener('input', () => {
      updateCodeStats();
      renderLanguages(searchInput.value);

      // Auto-save with debounce
      clearTimeout(window.autoSaveTimer);
      window.autoSaveTimer = setTimeout(() => {
        saveCodeToStorage(currentLanguage, codeEditor.value);
      }, 1000);
    });

    // Listen for console messages from iframe
    window.addEventListener('message', function(event) {
      if (event.data.type === 'console') {
        logToConsole(`🖥️ ${event.data.message}`, event.data.level || 'log');
      }
    });

    // Close modal when clicking outside
    window.addEventListener('click', function(event) {
      const modal = document.getElementById('clearModal');
      if (event.target === modal) {
        closeClearModal();
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey || e.metaKey) {
        switch(e.key) {
          case 'Enter':
            e.preventDefault();
            runCode();
            break;
          case 's':
            e.preventDefault();
            saveProject();
            break;
          case 'f':
            if (e.target !== searchInput) {
              e.preventDefault();
              searchInput.focus();
            }
            break;
        }
      }
    });

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      try {
        loadSavedCode();
        renderLanguages();
        switchLanguage(currentLanguage);
        updateCodeStats();
        updateStatus('CodeStudio Pro ready!', 'success');
        logToConsole('🚀 Welcome to CodeStudio Pro!', 'success');
        logToConsole('🔍 Use the search bar to find languages quickly', 'info');
        logToConsole('⌨️ Keyboard shortcuts: Ctrl+Enter (Run), Ctrl+S (Save), Ctrl+F (Search)', 'info');

        // Auto-run for web languages
        if (['html', 'css', 'javascript'].includes(currentLanguage)) {
          setTimeout(runCode, 1000);
        }
      } catch (error) {
        console.error('Initialization error:', error);
        updateStatus('Initialization error', 'error');
      }
    });
  </script>
</body>
</html>
